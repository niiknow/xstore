(function umd(require){if("object"==typeof exports){module.exports=require("1")}else if("function"==typeof define&&define.amd){define(function(){return require("1")})}else{this["gmodal"]=require("1")}})(function outer(modules,cache,entries){var global=function(){return this}();function require(name,jumped){if(cache[name])return cache[name].exports;if(modules[name])return call(name,require);throw new Error('cannot find module "'+name+'"')}function call(id,require){var m=cache[id]={exports:{}};var mod=modules[id];var name=mod[2];var fn=mod[0];fn.call(m.exports,function(req){var dep=modules[id][1][req];return require(dep?dep:req)},m,m.exports,outer,modules,cache,entries);if(name)cache[name]=cache[id];return cache[id].exports}for(var id in entries){if(entries[id]){global[entries[id]]=require(id)}else{require(id)}}require.duo=true;require.cache=cache;require.modules=modules;return require}({1:[function(require,module,exports){(function(){(function(win){var Deferred,Queue,cacheBust,createPromise,deferredObject,delay,doPostMessage,doc,handleMessageEvent,handleProxyMessage,hash,iframe,load,myproxy,onMessage,proxyPage,proxyWin,q,randomHash,storageKey,usePostMessage,xstore;doc=win.document;load=require("load-iframe");Queue=require("queue");q=new Queue({concurrency:1,timeout:1e3});proxyPage="http://niiknow.github.io/xstore/xstore.html";storageKey="xstore";deferredObject={};iframe=void 0;proxyWin=void 0;usePostMessage=win.postMessage!=null;cacheBust=0;hash=void 0;delay=333;onMessage=function(fn){if(doc.addEventListener){return doc.addEventListener("message",fn,false)}else{return doc.attachEvent("onmessage",fn)}};Deferred=function(){function Deferred(){}Deferred.prototype.callbacks=[];Deferred.prototype.errorbacks=[];Deferred.prototype.promise=function(func){var self;self=this;if(func){func(self.resolve,self.reject)}return self};Deferred.prototype.then=function(callback,errorback){var self;self=this;if(errorback){self.errorbacks[self.callbacks.length]=errorback}self.callbacks.push(callback);return self};Deferred.prototype.resolve=function(data){var e,i,l,self;self=this;i=0;l=self.callbacks.length;i;while(i<l){try{data=self.callbacks[i](data)}catch(_error){e=_error;if(self.errorbacks[i]){self.errorbacks[i](e)}else{throw new Error(e)}}i+=1}return self};Deferred.prototype.reject=function(e){var self;self=this;if(self.errorbacks.length){self.errorbacks[self.errorbacks.length](e)}else{throw new Error(e)}};return Deferred}();myproxy=function(){function myproxy(){}myproxy.prototype.delay=333;myproxy.prototype.hash=win.location.hash;myproxy.prototype.init=function(){var self;self=this;if(usePostMessage){return onMessage(handleProxyMessage)}else{return setInterval(function(){var newhash;newhash=win.location.hash;if(newhash!==hash){hash=newhash;handleProxyMessage({data:JSON.parse(newhash.substr(1))})}},self.delay)}};return myproxy}();handleProxyMessage=function(e){var d,id,key,method,myCacheBust,self;d=e.data;if(typeof d==="string"){if(/^xstore-/.test(d)){d=d.split(",")}else{try{d=JSON.parse(d)}catch(_error){return}}}if(!(d instanceof Array)){return}id=d[1];if(!/^xstore-/.test(id)){return}self=this;key=d[3]||"xstore";method=d[2];cacheBust=0;if(method==="get"){d[4]=store.get(key)}else if(method==="set"){store.set(key,d[4])}else if(method==="remove"){store.remove(key)}else if(method==="clear"){store.clear()}else{d[2]="error-"+method}if(usePostMessage){evt.source.postMessage(JSON.stringify(d),evt.origin)}else{cacheBust+=1;myCacheBust=+new Date+cacheBust;d[0]=myCacheBust;hash="#"+JSON.stringify(d);win.location=win.location.href.replace(globals.location.hash,"")+hash}};randomHash=function(){var rh;rh=Math.random().toString(36).substr(2);return"xstore-"+rh};doPostMessage=function(msg){if(proxyWin!=null){proxyWin.postMessage(msg,"*");return}return q.push(function(){return doPostMessage(msg)})};createPromise=function(event,item){return function(resolve,reject){var d,deferredHash;deferredHash=randomHash();d=[0,deferredHash,event,item.k,item.v];deferredObject[deferredHash]={resolve:resolve,reject:reject};if(usePostMessage){doPostMessage(JSON.stringify(d))}else{if(iframe!==null){cacheBust+=1;d[0]=+new Date+cacheBust;hash="#"+JSON.stringify(d);if(iframe.src){iframe.src=""+proxyPage+hash}else if(iframe.contentWindow!=null&&iframe.contentWindow.location!=null){iframe.contentWindow.location=""+proxyPage+hash}else{iframe.setAttribute("src",""+proxyPage+hash)}}}}};handleMessageEvent=function(e){var d,di,id;d=e.data;if(typeof d==="string"){if(/^xstore-/.test(d)){d=d.split(",")}else if(jsonEncode){try{d=JSON.parse(d)}catch(_error){return}}}if(!(d instanceof Array)){return}id=d[1];if(!/^xstore-/.test(id)){return}di=deferredObject[id];if(di){if(/^error-/.test(d[2])){di.reject(d[2])}else{di.reject(d[4])}return delete deferredObject[id]}};xstore=function(){function xstore(){}xstore.get=function(k){return(new Deferred).promise(createPromise("get",k))};xstore.set=function(k,v){return(new Deferred).promise(createPromise("set",{k:k,v:v}))};xstore.remove=function(k){return(new Deferred).promise(createPromise("remove",k))};xstore.clear=function(){return(new Deferred).promise(createPromise("clear"))};xstore.init=function(options){options=options||{};if(options.isProxy){(new myproxy).init();return}proxyPage=options.url||proxyPage;if(win.location.protocol==="https"){proxyPage=proxyPage.replace("http:","https:")}return iframe=load(proxyPage,function(){iframe.style.display="block";iframe.setAttribute("id","frame");proxyWin=iframe.contentWindow;if(!usePostMessage){hash=proxyWin.location.hash;return setInterval(function(){if(proxyWin.location.hash!==hash){hash=proxyWin.location.hash;handleMessageEvent({origin:proxyDomain,data:hash.substr(1)})}},delay)}else{return onMessage(handleMessageEvent)}})};return xstore}();win.xstore=xstore;return module["export"]=xstore})(window)}).call(this)},{"load-iframe":2,queue:3}],2:[function(require,module,exports){var onload=require("script-onload");var tick=require("next-tick");var type=require("type");module.exports=function loadIframe(options,fn){if(!options)throw new Error("Cant load nothing...");if("string"==type(options))options={src:options};var https=document.location.protocol==="https:"||document.location.protocol==="chrome-extension:";if(options.src&&options.src.indexOf("//")===0){options.src=https?"https:"+options.src:"http:"+options.src}if(https&&options.https)options.src=options.https;else if(!https&&options.http)options.src=options.http;var iframe=document.createElement("iframe");iframe.src=options.src;iframe.width=options.width||1;iframe.height=options.height||1;iframe.style.display="none";if("function"==type(fn)){onload(iframe,fn)}tick(function(){var firstScript=document.getElementsByTagName("script")[0];firstScript.parentNode.insertBefore(iframe,firstScript)});return iframe}},{"script-onload":4,"next-tick":5,type:6}],4:[function(require,module,exports){module.exports=function(el,fn){return el.addEventListener?add(el,fn):attach(el,fn)};function add(el,fn){el.addEventListener("load",function(_,e){fn(null,e)},false);el.addEventListener("error",function(e){var err=new Error('script error "'+el.src+'"');err.event=e;fn(err)},false)}function attach(el,fn){el.attachEvent("onreadystatechange",function(e){if(!/complete|loaded/.test(el.readyState))return;fn(null,e)});el.attachEvent("onerror",function(e){var err=new Error('failed to load the script "'+el.src+'"');err.event=e||window.event;fn(err)})}},{}],5:[function(require,module,exports){"use strict";if(typeof setImmediate=="function"){module.exports=function(f){setImmediate(f)}}else if(typeof process!="undefined"&&typeof process.nextTick=="function"){module.exports=process.nextTick}else if(typeof window=="undefined"||window.ActiveXObject||!window.postMessage){module.exports=function(f){setTimeout(f)}}else{var q=[];window.addEventListener("message",function(){var i=0;while(i<q.length){try{q[i++]()}catch(e){q=q.slice(i);window.postMessage("tic!","*");throw e}}q.length=0},true);module.exports=function(fn){if(!q.length)window.postMessage("tic!","*");q.push(fn)}}},{}],6:[function(require,module,exports){var toString=Object.prototype.toString;module.exports=function(val){switch(toString.call(val)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}if(val===null)return"null";if(val===undefined)return"undefined";if(val!==val)return"nan";if(val&&val.nodeType===1)return"element";val=val.valueOf?val.valueOf():Object.prototype.valueOf.apply(val);return typeof val}},{}],3:[function(require,module,exports){var Emitter;var bind;try{Emitter=require("component-emitter");bind=require("component-bind")}catch(err){Emitter=require("emitter");bind=require("bind")}module.exports=Queue;function Queue(options){options=options||{};this.timeout=options.timeout||0;this.concurrency=options.concurrency||1;this.pending=0;this.jobs=[]}Emitter(Queue.prototype);Queue.prototype.length=function(){return this.pending+this.jobs.length};Queue.prototype.push=function(fn,cb){this.jobs.push([fn,cb]);setTimeout(bind(this,this.run),0)};Queue.prototype.run=function(){while(this.pending<this.concurrency){var job=this.jobs.shift();if(!job)break;this.exec(job)}};Queue.prototype.exec=function(job){var self=this;var ms=this.timeout;var fn=job[0];var cb=job[1];if(ms)fn=timeout(fn,ms);this.pending++;fn(function(err,res){cb&&cb(err,res);self.pending--;self.run()})};function timeout(fn,ms){return function(cb){var done;var id=setTimeout(function(){done=true;var err=new Error("Timeout of "+ms+"ms exceeded");err.timeout=timeout;cb(err)},ms);fn(function(err,res){if(done)return;clearTimeout(id);cb(err,res)})}}},{"component-emitter":7,"component-bind":8,emitter:7,bind:8}],7:[function(require,module,exports){module.exports=Emitter;function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks["$"+event]=this._callbacks["$"+event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){function on(){this.off(event,on);fn.apply(this,arguments)}on.fn=fn;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks["$"+event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks["$"+event];return this}var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break}}return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks["$"+event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks["$"+event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{}],8:[function(require,module,exports){var slice=[].slice;module.exports=function(obj,fn){if("string"==typeof fn)fn=obj[fn];if("function"!=typeof fn)throw new Error("bind() requires a function");var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.concat(slice.call(arguments)))}}},{}]},{},{1:""}));